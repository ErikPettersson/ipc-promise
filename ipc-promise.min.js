/*!
 * @license ipc-promise Copyright(c) 2015 sasa+1
 * https://github.com/sasaplus1/ipc-promise
 * Released under the MIT license.
 */
!function(e,n){"use strict";"function"==typeof define&&define.amd?define(["electron","events"],n):"object"==typeof exports?module.exports=n(require("electron"),require("events")):e.ipcPromise=n(global.require("electron"),global.require("events"))}((this||0).self||global,function(e,n){"use strict";function t(e,n){var t=function(o){e.sender.send(c,{data:o,eventName:n.eventName,id:n.id}),u.removeListener(n.eventName+s,t),u.removeListener(n.eventName+v,i)},i=function(o){e.sender.send(d,{data:o,eventName:n.eventName,id:n.id}),u.removeListener(n.eventName+s,t),u.removeListener(n.eventName+v,i)};u.on(n.eventName+s,t),u.on(n.eventName+v,i),u.emit(n.eventName,n.data,e)}function i(e,n){return new Promise(function(t,i){var o=Math.floor(Math.random()*Number.MAX_SAFE_INTEGER),r=function(n,i){i.id===o&&i.eventName===e&&(a.removeListener(c,r),a.removeListener(d,s),t(i.data))},s=function(n,t){t.id===o&&t.eventName===e&&(a.removeListener(c,r),a.removeListener(d,s),i(t.data))};a.on(c,r),a.on(d,s),a.send(m,{data:n,eventName:e,id:o})})}function o(e,n){u.on(e,function(t,i){n(t,i).then(function(n){u.emit(e+s,n)}).catch(function(n){u.emit(e+v,n)})})}var r=e.ipcMain,a=e.ipcRenderer,m="ipc-promise-common-event",s="-success",v="-failure",c=m+s,d=m+v,u=new n.EventEmitter;return"undefined"==typeof window&&r.on(m,t),{on:o,send:i}});