/*!
 * @license ipc-promise Copyright(c) 2015 sasa+1
 * https://github.com/sasaplus1/ipc-promise
 * Released under the MIT license.
 */
!function(e,n){"use strict";"function"==typeof define&&define.amd?define(["ipc","events"],n):"object"==typeof exports?module.exports=n(require("ipc"),require("events")):e.ipcPromise=n(global.require("ipc"),global.require("events"))}((this||0).self||global,function(e,n){"use strict";function t(e,n){f.on(n.event+d,function(t){e.sender.send(s,{data:t,event:n.event,id:n.id})}),f.on(n.event+c,function(t){e.sender.send(u,{data:t,event:n.event,id:n.id})}),f.emit(n.event,n.data)}function i(n,t){return new Promise(function(i,o){var d,c,f=Math.floor(Math.random()*Number.MAX_SAFE_INTEGER);e.on(s,d=function(t){t.id===f&&t.event===n&&(e.removeListener(s,d),e.removeListener(u,c),i(t.data))}),e.on(u,c=function(t){t.id===f&&t.event===n&&(e.removeListener(s,d),e.removeListener(u,c),o(t.data))}),e.send(r,{data:t,event:n,id:f})})}function o(e,n){f.on(e,function(t){n(t).then(function(n){f.emit(e+d,n)})["catch"](function(n){f.emit(e+c,n)})})}var r="ipc-promise-common-event",d="-success",c="-failure",s=r+d,u=r+c,f=new n.EventEmitter;return"undefined"==typeof window&&e.on(r,t),{on:o,send:i}});