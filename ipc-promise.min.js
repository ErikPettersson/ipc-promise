/*!
 * @license ipc-promise Copyright(c) 2015 sasa+1
 * https://github.com/sasaplus1/ipc-promise
 * Released under the MIT license.
 */
!function(e,n){"use strict";"function"==typeof define&&define.amd?define(["ipc","events"],n):"object"==typeof exports?module.exports=n(require("ipc"),require("events")):e.ipcPromise=n(global.require("ipc"),global.require("events"))}((this||0).self||global,function(e,n){"use strict";function t(e,n){a.on(n.event+c,function(t){e.sender.send(u,{data:t,event:n.event,id:n.id})}),a.on(n.event+s,function(t){e.sender.send(d,{data:t,event:n.event,id:n.id})}),a.emit(n.event,n.data)}function i(n,t){return new Promise(function(i,o){var c,s,a=Math.floor(Math.random()*Number.MAX_SAFE_INTEGER);e.on(u,c=function(t){t.id===a&&t.event===n&&(e.removeListener(u,c),e.removeListener(d,s),i(t.data))}),e.on(d,s=function(t){t.id===a&&t.event===n&&(e.removeListener(u,c),e.removeListener(d,s),o(t.data))}),e.send(r,{data:t,event:n,id:a})})}function o(e,n){a.on(e,function(t){n(t).then(function(n){a.emit(e+c,n)})["catch"](function(n){a.emit(e+s,n)})})}var r="ipc-promise-common-event",c="-success",s="-failure",u=r+c,d=r+s,a=new n.EventEmitter;return e.on(r,t),{on:o,send:i}});